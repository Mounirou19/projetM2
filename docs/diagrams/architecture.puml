@startuml Architecture-CineManga

!theme aws-orange

title Architecture Syst√®me - Cin√©Manga Platform

' === STYLE ===

!define CONTAINER_STYLE(color) skinparam node {BackgroundColor color; BorderColor Black}

' Couches principales

package "Frontend Layer" #lightblue {

' === COUCHE PR√âSENTATION ===
node "üåê Frontend (Port 3000)" as FRONTEND #LightBlue {
    component "React 18.3" as REACT {
        component [Router] as router
        component [Components] as components
        component [React App] as react
        component [HomePage] as homepage
        component [LoginPage] as loginpage
        component [Services] as services    

        component [RegisterPage] as registerpage
        component [MediaPage] as mediapage
        component [ProfilPage] as profilpage
        component [AdminPage] as adminpage
        component [ContactPage] as contactpage
        
        react --> router
        react --> components
        react --> services
    }
}

package "Reverse Proxy Layer" #lightgreen {

        component [Nginx] as nginx
    }
    component "React Router" as ROUTER
    component "Axios/Fetch" as HTTP
    
    note right of nginx
        - Load balancing

          - SSL termination

    REACT --> ROUTER      - Static files serving

    REACT --> HTTP      - Request routing

}    end note

}

' === COUCHE REVERSE PROXY ===

node "üîÑ Reverse Proxy (Port 8083)" as PROXY #Orange {package "Backend Layer" #lightyellow {

    component "Nginx Alpine" as NGINX {    package "Symfony Framework" {

        [Load Balancing]        component [Controllers] as controllers

        [SSL Termination]        component [Services] as sf_services

        [Static Files]        component [Entities] as entities

        [CORS Headers]        component [Repositories] as repositories

    }        component [Security] as security

}        

        controllers --> sf_services

' === COUCHE APPLICATION ===        sf_services --> repositories

node "‚ö° Backend API (Port 9000)" as BACKEND #LightGreen {        repositories --> entities

    component "Symfony 7.1 (PHP 8.2)" as SYMFONY {        controllers --> security

        package "Controllers" {    }

            [AuthController]    

            [MediaController]    component [JWT Manager] as jwt

            [ProfilController]    component [Doctrine ORM] as doctrine

            [AdminController]    

            [ContactController]    security --> jwt

        }    repositories --> doctrine

        }

        package "Services" {

            [JWT Manager]package "Database Layer" #lightcoral {

            [Entity Manager]    database [MySQL 8.0] as mysql

            [Validator]    component [phpMyAdmin] as phpmyadmin

            [Security]    

        }    phpmyadmin --> mysql

        }

        package "Entities" {

            [Users]package "Infrastructure Layer" #lightgray {

            [Medias]    component [Docker Engine] as docker

            [Profils]    component [Docker Compose] as compose

            [Contacts]    

        }    docker --> compose

    }}

    

    component "Doctrine ORM" as ORM' Flux de donn√©es

    component "LexikJWT Bundle" as JWT_BUNDLEreact --> nginx : HTTP/HTTPS Requests

}nginx --> controllers : Proxy to PHP-FPM

controllers --> mysql : Database Queries via Doctrine

' === COUCHE DONN√âES ===mysql --> controllers : Query Results

node "üóÑÔ∏è Base de Donn√©es (Port 3306)" as DATABASE #LightYellow {

    database "MySQL 8.0" as MYSQL {' Connexions infrastructure

        [users]compose --> react : Container Management

        [medias]compose --> nginx : Container Management

        [profils]compose --> controllers : Container Management

        [contacts]compose --> mysql : Container Management

    }compose --> phpmyadmin : Container Management

}

' Services externes (futures extensions)

' === OUTILS D'ADMINISTRATION ===cloud "External Services" #white {

node "üîß Administration (Port 8081)" as ADMIN_TOOLS #Pink {    component [CDN] as cdn

    component "phpMyAdmin" as PHPMYADMIN    component [Email Service] as email

}    component [Video Streaming] as streaming

    component [Analytics] as analytics

' === STOCKAGE ===}

node "üìÅ Stockage Fichiers" as STORAGE #LightGray {

    folder "Static Assets" as STATIC' Connexions externes futures

    folder "Media Images" as IMAGESreact -.-> cdn : Static Assets

    folder "Logs" as LOGScontrollers -.-> email : Notifications

    file "notifications.log" as NOTIF_LOGcontrollers -.-> streaming : Video Content

}react -.-> analytics : User Tracking



' === CONTENEURISATION ===' D√©tails des composants

node "üê≥ Docker Environment" as DOCKER #LightCyan {note right of react

    component "Docker Compose" as COMPOSE {  <b>React Components:</b>

        [react service]  - HomePage

        [web service (PHP-FPM)]  - MediaPage

        [nginx service]  - AdminPage

        [database service]  - ProfilPage

        [phpmyadmin service]  - AuthPages

    }  

      <b>State Management:</b>

    component "Docker Networks" as NETWORKS  - Local State (useState)

    component "Docker Volumes" as VOLUMES  - JWT Token Storage

}  - User Context

end note

' === FLUX DE DONN√âES ===

FRONTEND --> NGINX : "HTTP/HTTPS\nRequests"note right of controllers

NGINX --> SYMFONY : "FastCGI\nPHP-FPM"  <b>Main Controllers:</b>

SYMFONY --> ORM : "Entity\nOperations"  - AuthController (JWT)

ORM --> MYSQL : "SQL\nQueries"  - MediaController (CRUD)

  - AdminController (Management)

' === FLUX ADMINISTRATIFS ===  - ProfilController (Favorites)

PHPMYADMIN --> MYSQL : "Database\nAdministration"  - ContactController (Messages)

end note

' === STOCKAGE ET LOGS ===

SYMFONY --> LOGS : "Application\nLogs"note right of mysql

SYMFONY --> NOTIF_LOG : "Contact\nNotifications"  <b>Database Schema:</b>

NGINX --> STATIC : "Static\nFiles"  - users (authentication)

SYMFONY --> IMAGES : "Media\nImages"  - medias (content)

  - profils (favorites)

' === S√âCURIT√â ===  - contacts (messages)

SYMFONY --> JWT_BUNDLE : "Token\nGeneration"  

SYMFONY --> Security : "Authentication\nAuthorization"  <b>Features:</b>

  - ACID Compliance

' === CONFIGURATION R√âSEAU ===  - Foreign Key Constraints

note right of FRONTEND : "Port: 3000\nEnvironment: Development\nHot Reload: Enabled"  - Indexing for Performance

end note

note right of NGINX : "Port: 8083\nSSL: Ready\nGzip: Enabled\nCORS: Configured"

' S√©curit√©

note right of SYMFONY : "Port: 9000 (internal)\nEnvironment: dev/prod\nDebug: Configurable"package "Security Layer" #pink {

    component [CORS Protection] as cors

note right of MYSQL : "Port: 3306\nVersion: 8.0\nCharset: utf8mb4"    component [JWT Authentication] as jwt_auth

    component [Input Validation] as validation

note right of PHPMYADMIN : "Port: 8081\nMySQL Management\nDevelopment Only"    component [Admin Access Control] as admin_access

    

' === S√âCURIT√â ET AUTHENTIFICATION ===    nginx --> cors

note as SECURITY    controllers --> jwt_auth

**S√©curit√©:**    controllers --> validation

‚Ä¢ JWT Authentication    controllers --> admin_access

‚Ä¢ CORS Configuration}

‚Ä¢ Password Hashing (bcrypt)

‚Ä¢ Admin Token Validation' Monitoring et logs

‚Ä¢ Role-based Access Controlpackage "Monitoring Layer" #lightyellow {

‚Ä¢ SQL Injection Protection (Doctrine)    component [Application Logs] as app_logs

end note    component [Nginx Logs] as nginx_logs

    component [Database Logs] as db_logs

' === PERFORMANCES ===    component [Contact Notifications] as notifications

note as PERFORMANCE    

**Performances:**    controllers --> app_logs

‚Ä¢ Nginx Reverse Proxy    nginx --> nginx_logs

‚Ä¢ PHP OPcache    mysql --> db_logs

‚Ä¢ MySQL Query Optimization    controllers --> notifications

‚Ä¢ Static File Caching}

‚Ä¢ Gzip Compression

‚Ä¢ Connection Pooling' Volumes de donn√©es

end notestorage "Data Persistence" #lightsteelblue {

    folder [Database Volume] as db_volume

' === MONITORING ===    folder [Log Files] as log_files

note as MONITORING    folder [Static Assets] as static_files

**Monitoring & Logs:**    folder [Upload Directory] as uploads

‚Ä¢ Symfony Profiler}

‚Ä¢ MySQL Slow Query Log

‚Ä¢ Nginx Access/Error Logsmysql --> db_volume

‚Ä¢ PHP-FPM Statusapp_logs --> log_files

‚Ä¢ Contact Notifications Logreact --> static_files

‚Ä¢ Application Error Trackingcontrollers --> uploads

end note

' Configuration

@endumlpackage "Configuration Layer" #lightcyan {
    file [Environment Variables] as env
    file [Docker Compose Config] as docker_config
    file [Nginx Config] as nginx_config
    file [Symfony Config] as symfony_config
    
    compose --> docker_config
    nginx --> nginx_config
    controllers --> symfony_config
    controllers --> env
}

@enduml
